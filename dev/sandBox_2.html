<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title></title>
  <script type="text/javascript" src="defSandBox.php"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <style type="text/css">

    #jquery-sample {
        margin: 10px;
        width: 200px;
    }
    #jquery-sample-ajax {
        margin: 10px;
        padding: 10px;
        height: 100px;
        background-color: yellow;
        border: 1px solid gray;
        border-radius: 10px;
    }
    
    </style>
 
<!--    以下は新居さんがアドバイスしてくれたScript-->
    <script type="text/javascript">
        INTERMediatorOnPage.doBeforeConstruct = function() {
        INTERMediator.navigationLabel = ["最初へ", null, null, "最後へ", null, null, null, null, false];
        }
        INTERMediatorOnPage.doAfterConstruct = function () {
        if (!INTERMediator.partialConstructing) {
            var context = IMLibContextPool.contextFromName('atmos_list');
            var keys = Object.keys(context.store);
            var buttonId = context.store[keys[0]]['_im_button_master_id'];
            document.getElementById(buttonId).click();
        }
    }
   
    $(function() {
        var $updateInputs = $("#update-data-form").find("input");
        
        $updateInputs.on("click", function() {
            var $this = $(this); 
            $.ajax({
            type: "POST",
            url: "gitPull.php",
            data: {
            id: $this.attr("id")
            },
            success: function() {
            $this.val("更新完了");
            },
            error: function(){
            $this.val("更新失敗 !!!");
            }
            })
       });
    });
    

        </script>
</head>
<body>
<input type="text" data-im="_@condition:atmos_list:date:*match*">
  <button data-im="_@update:atmos_list@">検索</button>
  レコード数：<select data-im="_@limitnumber:atmos_list">
  <option value="5" selected="selected">5</option>
  <option value="10">10</option>
  <option value="20">20</option>
  </select>
<a href="https://ambidata.io/ch/channel.html?id=999">現地気象データ／グラフ表☕️</a>
<a href="http://mochimugi.sakura.ne.jp/seasonShots/index_sandBox.html">ホームページ</a>

<!--
<div id="jquery-sample">
    <p>
        <button style ="position: absolute; right: 0px; top: 0px" id="jquery-sample-button">Git Pull</button>
        <span id="jquery-sample-textStatus"></span>
    </p>
    <div id="jquery-sample-ajax"></div>
</div>
-->

<form style ="position: absolute; right: 0px; top: 0px" id="update-data-form">
    <input type="button" value="プログラム更新" id="gitUpdate" />
</form>
    


<!--<form name="f1" action="gitPull.php" method="post">
    <input type="submit" name="submit" value="アップデート" />
    </form>

<button style ="position: absolute; right: 0px; top: 0px" type="submit" name="gitPull.php" value="gitPull.php">アップデート</button>
-->
	<div id="IM_NAVIGATOR"></div>
    <table width=100%>
        <thead>
            <tr><th></th>
                <th>日付<br>
                <span style="cursor: pointer" data-im="_@addorder:atmos_list@:date:asc">［昇順］</span>
                <span style="cursor: pointer" data-im="_@addorder:atmos_list@:date:desc">［降順］</span></th>
                <th>温度（℃）</th><th>CPU温度（℃）</th><th>気圧（hPa）</th><th>湿度（%）</th><th>明るさ lux<br>（5000以下は曇り）</th><th>電池 v</th><th>Solar</th><th>外気温</th></tr>
        </thead>
        <tbody>
            <tr style="text-align:right">
                <td></td><!--詳細ボタン表示用のエリアを用意しておく-->
				<td data-im="atmos_list@date"></td>
				<td data-im="atmos_list@temp atmos_list@color_temp@style.color"></td>
				<td data-im="atmos_list@cpu_temp"></td>
				<td data-im="atmos_list@pressure"></td>
				<td data-im="atmos_list@humid"></td>
				<td data-im="atmos_list@lux atmos_list@color_lux@style.color"></td>
				<td data-im="atmos_list@v0"></td>
				<td data-im="atmos_list@v1"></td>
                <td data-im="atmos_list@outer_temp"></td>
            </tr>
        </tbody>
    </table>
    <table>
        <tr><th>id</th>
            <td data-im="atmos_detail@id"></td>
        </tr>
        <tr><th>date</th>
            <td data-im="atmos_detail@date"></td>
        </tr>
        <tr><th>接続間隔</th>
            <td data-im="atmos_detail@diff_time"></td>
        </tr>
    <tr><th>ケース内温度</th>
            <td data-im="atmos_detail@temp"></td>
        </tr>
        <tr><th>気圧</th>
            <td data-im="atmos_detail@pressure"></td>
        </tr>
        <tr><th>湿度</th>
            <td data-im="atmos_detail@humid"></td>
        </tr>
        <tr><th>照度</th>
            <td data-im="atmos_detail@lux"></td>
        </tr>
        <tr><th>CPU温度</th>
            <td data-im="atmos_detail@cpu_temp"></td>
        </tr>
        <tr><th>外気温</th>
            <td data-im="atmos_detail@outer_temp"></td>
        </tr>
        <tr><th>外気圧</th>
            <td data-im="atmos_detail@outer_pressure"></td>
        </tr>
        <tr><th>外湿度</th>
            <td data-im="atmos_detail@outer_humid"></td>
        </tr>
        <tr><th>太陽光発電電圧</th>
            <td data-im="atmos_detail@v0"></td>
        </tr>
        <tr><th>バッテリー電圧</th>
            <td data-im="atmos_detail@v1"></td>
        </tr>
        <tr><th>log</th>
            <td> <textarea cols=80 rows=20 data-im="atmos_detail@log"></textarea></td>
        </tr>
    </table>
</body>

